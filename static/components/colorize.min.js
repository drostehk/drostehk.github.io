!function(e,n,i,t){"use strict";n=void 0!==n&&n.Math==Math?n:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e.fn.colorize=function(n){var i=e.isPlainObject(n)?e.extend(!0,{},e.fn.colorize.settings,n):e.extend({},e.fn.colorize.settings),t=arguments||!1;return e(this).each(function(n){var o,a,r,c,s,d,g,l,u=e(this),f=e("<canvas />")[0],m=e("<canvas />")[0],h=e("<canvas />")[0],p=new Image,v=i.colors,w=(i.paths,i.namespace),b=i.error,y=u.data("module-"+w);if(l={checkPreconditions:function(){return l.debug("Checking pre-conditions"),!(!e.isPlainObject(v)||e.isEmptyObject(v))||(l.error(b.undefinedColors),!1)},async:function(e){i.async?setTimeout(e,0):e()},getMetadata:function(){l.debug("Grabbing metadata"),c=u.data("image")||i.image||void 0,s=u.data("name")||i.name||n,d=i.width||u.width(),g=i.height||u.height(),0!==d&&0!==g||l.error(b.undefinedSize)},initialize:function(){l.debug("Initializing with colors",v),l.checkPreconditions()&&l.async(function(){l.getMetadata(),l.canvas.create(),l.draw.image(function(){l.draw.colors(),l.canvas.merge()}),u.data("module-"+w,l)})},redraw:function(){l.debug("Redrawing image"),l.async(function(){l.canvas.clear(),l.draw.colors(),l.canvas.merge()})},change:{color:function(e,n){if(l.debug("Changing color",e),void 0===v[e])return l.error(b.missingColor),!1;v[e]=n,l.redraw()}},canvas:{create:function(){l.debug("Creating canvases"),f.width=d,f.height=g,m.width=d,m.height=g,h.width=d,h.height=g,o=f.getContext("2d"),a=m.getContext("2d"),r=h.getContext("2d"),u.append(f),o=u.children("canvas")[0].getContext("2d")},clear:function(e){l.debug("Clearing canvas"),r.fillStyle="#FFFFFF",r.fillRect(0,0,d,g)},merge:function(){e.isFunction(o.blendOnto)?(o.putImageData(a.getImageData(0,0,d,g),0,0),r.blendOnto(o,"multiply")):l.error(b.missingPlugin)}},draw:{image:function(e){l.debug("Drawing image"),e=e||function(){},c?(p.src=c,p.onload=function(){a.drawImage(p,0,0),e()}):(l.error(b.noImage),e())},colors:function(){l.debug("Drawing color overlays",v),e.each(v,function(e,n){i.onDraw(r,s,e,n)})}},debug:function(e,n){i.debug&&(void 0!==n?console.info(i.name+": "+e,n):console.info(i.name+": "+e))},error:function(e){console.warn(i.name+": "+e)},invoke:function(n,t,o){var a;return o=o||Array.prototype.slice.call(arguments,2),"string"==typeof n&&void 0!==y&&(n=n.split("."),e.each(n,function(n,t){return e.isPlainObject(y[t])?(y=y[t],!0):e.isFunction(y[t])?(a=y[t],!0):(l.error(i.error.method),!1)})),!!e.isFunction(a)&&a.apply(t,o)}},void 0!==y&&t)return"invoke"==t[0]&&(t=Array.prototype.slice.call(t,1)),l.invoke(t[0],this,Array.prototype.slice.call(t,1));l.initialize()}),this},e.fn.colorize.settings={name:"Image Colorizer",debug:!0,namespace:"colorize",onDraw:function(e,n,i,t){},async:!0,colors:{},metadata:{image:"image",name:"name"},error:{noImage:"No tracing image specified",undefinedColors:"No default colors specified.",missingColor:"Attempted to change color that does not exist",missingPlugin:"Blend onto plug-in must be included",undefinedHeight:"The width or height of image canvas could not be automatically determined. Please specify a height."}}}(jQuery,window,document);