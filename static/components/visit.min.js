!function(e,i,t,n){"use strict";i=void 0!==i&&i.Math==Math?i:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e.visit=e.fn.visit=function(t){var n,o=e(e.isFunction(this)?i:this),r=o.selector||"",s=(new Date).getTime(),c=[],a=arguments[0],d="string"==typeof a,u=[].slice.call(arguments,1);return o.each(function(){var l,g=e.isPlainObject(t)?e.extend(!0,{},e.fn.visit.settings,t):e.extend({},e.fn.visit.settings),v=g.error,f=g.namespace,m=f+"-module",p=e(this),h=e(),b=this,y=p.data(m);l={initialize:function(){g.count?l.store(g.key.count,g.count):g.id?l.add.id(g.id):g.increment&&"increment"!==d&&l.increment(),l.add.display(p),l.instantiate()},instantiate:function(){l.verbose("Storing instance of visit module",l),y=l,p.data(m,l)},destroy:function(){l.verbose("Destroying instance"),p.removeData(m)},increment:function(e){var i=+l.get.count()+1;e?l.add.id(e):(i>g.limit&&!g.surpass&&(i=g.limit),l.debug("Incrementing visits",i),l.store(g.key.count,i))},decrement:function(e){var i=+l.get.count()-1;e?l.remove.id(e):(l.debug("Removing visit"),l.store(g.key.count,i))},get:{count:function(){return+l.retrieve(g.key.count)||0},idCount:function(e){return(e=e||l.get.ids()).length},ids:function(e){var i=[];return"string"==typeof(e=e||l.retrieve(g.key.ids))&&(i=e.split(g.delimiter)),l.verbose("Found visited ID list",i),i},storageOptions:function(e){var i={};return g.expires&&(i.expires=g.expires),g.domain&&(i.domain=g.domain),g.path&&(i.path=g.path),i}},has:{visited:function(i,t){var n=!1;return t=t||l.get.ids(),void 0!==i&&t&&e.each(t,function(e,t){t==i&&(n=!0)}),n}},set:{count:function(e){l.store(g.key.count,e)},ids:function(e){l.store(g.key.ids,e)}},reset:function(){l.store(g.key.count,0),l.store(g.key.ids,null)},add:{id:function(e){var i=l.retrieve(g.key.ids),t=void 0===i||""===i?e:i+g.delimiter+e;l.has.visited(e)?l.debug("Unique content already visited, not adding visit",e,i):void 0===e?l.debug("ID is not defined"):(l.debug("Adding visit to unique content",e),l.store(g.key.ids,t)),l.set.count(l.get.idCount())},display:function(i){var t=e(i);t.length>0&&!e.isWindow(t[0])&&(l.debug("Updating visit count for element",t),h=h.length>0?h.add(t):t)}},remove:{id:function(i){var t=l.get.ids(),n=[];void 0!==i&&void 0!==t&&(l.debug("Removing visit to unique content",i,t),e.each(t,function(e,t){t!==i&&n.push(t)}),n=n.join(g.delimiter),l.store(g.key.ids,n)),l.set.count(l.get.idCount())}},check:{limit:function(e){e=e||l.get.count(),g.limit&&(e>=g.limit&&(l.debug("Pages viewed exceeded limit, firing callback",e,g.limit),g.onLimit.call(b,e)),l.debug("Limit not reached",e,g.limit),g.onChange.call(b,e)),l.update.display(e)}},update:{display:function(e){e=e||l.get.count(),h.length>0&&(l.debug("Updating displayed view count",h),h.html(e))}},store:function(t,n){var o=l.get.storageOptions(n);if("localstorage"==g.storageMethod&&void 0!==i.localStorage)i.localStorage.setItem(t,n),l.debug("Value stored using local storage",t,n);else{if(void 0===e.cookie)return void l.error(v.noCookieStorage);e.cookie(t,n,o),l.debug("Value stored using cookie",t,n,o)}t==g.key.count&&l.check.limit(n)},retrieve:function(t,n){var o;return"localstorage"==g.storageMethod&&void 0!==i.localStorage?o=i.localStorage.getItem(t):void 0!==e.cookie?o=e.cookie(t):l.error(v.noCookieStorage),"undefined"!=o&&"null"!=o&&void 0!==o&&null!==o||(o=void 0),o},setting:function(i,t){if(e.isPlainObject(i))e.extend(!0,g,i);else{if(void 0===t)return g[i];g[i]=t}},internal:function(i,t){if(l.debug("Changing internal",i,t),void 0===t)return l[i];e.isPlainObject(i)?e.extend(!0,l,i):l[i]=t},debug:function(){!g.silent&&g.debug&&(g.performance?l.performance.log(arguments):(l.debug=Function.prototype.bind.call(console.info,console,g.name+":"),l.debug.apply(console,arguments)))},verbose:function(){!g.silent&&g.verbose&&g.debug&&(g.performance?l.performance.log(arguments):(l.verbose=Function.prototype.bind.call(console.info,console,g.name+":"),l.verbose.apply(console,arguments)))},error:function(){g.silent||(l.error=Function.prototype.bind.call(console.error,console,g.name+":"),l.error.apply(console,arguments))},performance:{log:function(e){var i,t;g.performance&&(t=(i=(new Date).getTime())-(s||i),s=i,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:b,"Execution Time":t})),clearTimeout(l.performance.timer),l.performance.timer=setTimeout(l.performance.display,500)},display:function(){var i=g.name+":",t=0;s=!1,clearTimeout(l.performance.timer),e.each(c,function(e,i){t+=i["Execution Time"]}),i+=" "+t+"ms",r&&(i+=" '"+r+"'"),o.length>1&&(i+=" ("+o.length+")"),(void 0!==console.group||void 0!==console.table)&&c.length>0&&(console.groupCollapsed(i),console.table?console.table(c):e.each(c,function(e,i){console.log(i.Name+": "+i["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(i,t,o){var r,s,c,a=y;return t=t||u,o=b||o,"string"==typeof i&&void 0!==a&&(i=i.split(/[\. ]/),r=i.length-1,e.each(i,function(t,n){var o=t!=r?n+i[t+1].charAt(0).toUpperCase()+i[t+1].slice(1):i;if(e.isPlainObject(a[o])&&t!=r)a=a[o];else{if(void 0!==a[o])return s=a[o],!1;if(!e.isPlainObject(a[n])||t==r)return void 0!==a[n]&&(s=a[n],!1);a=a[n]}})),e.isFunction(s)?c=s.apply(o,t):void 0!==s&&(c=s),e.isArray(n)?n.push(c):void 0!==n?n=[n,c]:void 0!==c&&(n=c),s}},d?(void 0===y&&l.initialize(),l.invoke(a)):(void 0!==y&&y.invoke("destroy"),l.initialize())}),void 0!==n?n:this},e.fn.visit.settings={name:"Visit",debug:!1,verbose:!1,performance:!0,namespace:"visit",increment:!1,surpass:!1,count:!1,limit:!1,delimiter:"&",storageMethod:"localstorage",key:{count:"visit-count",ids:"visit-ids"},expires:30,domain:!1,path:"/",onLimit:function(){},onChange:function(){},error:{method:"The method you called is not defined",missingPersist:"Using the persist setting requires the inclusion of PersistJS",noCookieStorage:"The default storage cookie requires $.cookie to be included."}}}(jQuery,window,document);