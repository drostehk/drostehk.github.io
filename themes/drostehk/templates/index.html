{% extends "base.html" %} {% block content %}
<section id="content" class="index_container">
  <div class="ui text container">
      {% block content_title %}
      <!-- <h2 class="ui center aligned header">Kickass Graphic</h2> {% endblock %} -->
      <div id="d3"></div>
  </div>
  <!-- <img class="ui fluid image" src="/img/stripe.png"> -->
</section>


<style type="text/css">
  #content {background-color:#303162;}
</style> <!-- // blue -->





<script type="text/javascript">
  
  var width = 960,
      height = 500;

  var x = d3.scale.linear()
      .domain([-5, 5])
      .range([0, width]);

  var y = d3.scale.linear()
      .domain([-5, 5])
      .range([0, height]);

  var data = d3.range(3).map(function(ind) {
    return {
      xloc: 0, 
      yloc: 0,
      xdel: 0, 
      ydel: 0
    };
  });

  // var colours = ["#C6276C", "#FFFFFF", "#F7B95F"];
  var colours = ["url(#gradient)", "#303162", "#FFFFFF"];
  var radii = [height / 3 , height / 4 , height / 5 ];

  var svg = d3.select("#d3").append("svg")
    .attr('width', width)
    .attr('height', height);

  var gradient = svg.append("svg:defs")
      .append("svg:linearGradient")
      .attr("id", "gradient")
      .attr("x1", "0%")
      .attr("y1", "0%")
      .attr("x2", "100%")
      .attr("y2", "100%")
      .attr("spreadMethod", "pad");

  gradient.append("svg:stop")
      .attr("offset", "0%")
      .attr("stop-color", "#C6276C")
      .attr("stop-opacity", 1);

  gradient.append("svg:stop")
      .attr("offset", "100%")
      .attr("stop-color", "#F7B95F")
      .attr("stop-opacity", 1);

  var circles = svg.selectAll('circle')
      .data(data)
      .enter().append('circle')
      .attr("cx", function(d) { return d.xloc; } )
      .attr("cy", function(d) { return d.yloc; })
      // .attr("cx", function(d) { return x(d.xloc); } )
      // .attr("cy", function(d) { return y(d.yloc); })
      .attr("r", 1 );
  // var bg = svg.select()
  
  var stopSwarm = false;

  d3.timer(function() {

    if (!stopSwarm) {
      data.forEach(function(d) {
        d.xloc += d.xdel;
        d.yloc += d.ydel;
        d.xdel += 0.03 * (Math.random() - .5) - 0.05 * d.xdel - 0.0005 * d.xloc;
        d.ydel += 0.03 * (Math.random() - .5) - 0.05 * d.ydel - 0.0005 * d.yloc;
      });

      circles
        .transition()
        .duration(100)
        .attr("transform", function(d) { return "translate(" + x(d.xloc) + "," + y(d.yloc) + ")"; })
        .attr("r", function(d) { return Math.min(1 + 1000 * Math.abs(d.xdel * d.ydel), 15); })
        // .attr("r", 15)
        .style("stroke", function(d, i) { return colours[i]; })
        .style("fill",  "none");
        // .each(temp_func);
    } else {
      data.forEach(function(d, i) {
        d.xloc = 0;
        d.yloc = 0;
        d.xdel = 0;
        d.ydel = 0;
        // d.radius = radii[i]; // logo stuff        
      });

      circles
        .transition()
        .duration(100)
        .attr("transform", function(d) { return "translate(" + x(d.xloc) + "," + y(d.yloc) + ")"; })
        .attr("r", function(d, i) { return radii[i]; })
        .style("fill",  function(d, i) { return colours[i]; });

    }



    // return stopSwarm;

  });




</script>


{% endblock content %}
